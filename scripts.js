const documents = {
    "Guatemala": [
        {
            title: "Aporte de las mujeres, pueblos indígenas y comunidades locales",
            description: "Elaborado por el Consejo Nacional de Áreas Protegidas de Guatemala, este documento aborda la importancia de proteger el conocimiento tradicional y promover la conservación de la biodiversidad en el país, reconociendo el papel fundamental de las mujeres, pueblos indígenas y comunidades locales en la gestión sostenible de los recursos naturales.",
            image: "https://www.proyectomesoamerica.org/images/PM/2024/destacados/PEI.jpg",
            link: "https://920-my.sharepoint.com/:b:/g/personal/o_fuentes_proyectomesoamerica_org/EZI7fXvDNgFOhE03cVvxxhcBVovRsyDL-jdYxDD59KO27Q?e=jKuCLS"
        },
        {
            title: "Década Restauración de Ecosistemas NU",
            description: "Una guía detallada que presenta la Estrategia de la Década de las Naciones Unidas sobre la Restauración de Ecosistemas. Aborda la visión, la teoría del cambio y las vías de implementación para la restauración y conservación de los recursos naturales a nivel mundial.",
            image: "https://www.proyectomesoamerica.org/images/PM/2024/destacados/PEI.jpg",
            link: "https://920-my.sharepoint.com/:b:/g/personal/o_fuentes_proyectomesoamerica_org/EX-6bmyFBT1Iso9qGbGnDWoBNQcEuHPwCoO_c3okDGvZgQ?e=xDza5j"
        },
        {
            title: "ERAM de CCAD",
            description: "ERAM es un plan estratégico que establece los objetivos y acciones para mejorar la calidad ambiental de la región. Se enfoca en cinco ejes transversales: fortalecimiento de capacidades, marco legal, diálogo intersectorial, investigación y tecnologías, y enfoque de género e interculturalidad.",
            image: "https://www.proyectomesoamerica.org/images/PM/2024/destacados/PEI.jpg",
            link: "https://920-my.sharepoint.com/:b:/g/personal/o_fuentes_proyectomesoamerica_org/EWd6UyCrliFChqNOM1HijyQBhBxPqCgDVE5wMYJn9LRcAg?e=1hzJ5z"
        },
        {
            title: "Estrategia Investigación MC",
            description: "La Estrategia Nacional para la Investigación y Manejo de los Recursos Marino-Costeros en Guatemala, proporciona información sobre los Mapas de Valoración (MdV) y establece un esquema de gobernanza para la implementación y actualización de la ENIMC.",
            image: "https://via.placeholder.com/150",
            link: "https://920-my.sharepoint.com/:b:/g/personal/o_fuentes_proyectomesoamerica_org/Ea2b90JNVztMtclge73_0QwBheq-0qUyrjM2OPoKqiyANA?e=PLG1Ga"
        },
        {
            title: "Diagnóstico de la ZMC del Caribe",
            description: "Un informe diagnóstico sobre la zona marino-costera del Caribe de Guatemala. Se enfoca en el diseño y desarrollo de un sistema de monitoreo, evaluación y reporte para el Componente de Adaptación al Cambio Climático del Sistema Nacional de Información sobre Cambio Climático.",
            image: "https://via.placeholder.com/150",
            link: "https://920-my.sharepoint.com/:b:/g/personal/o_fuentes_proyectomesoamerica_org/EeGTQpXqCzZPopcbSmjElAgB_sQzXQUd2y35vFnbTXS4Zw?e=KU0oi1"
        }
    ],
    "El Salvador": [
        {
            title: "Programa Nacional de Conservación de Caimán y Cocodrilo",
            description: "Desarrollado por el Ministerio de Medio Ambiente y Recursos Naturales de El Salvador, este programa tiene como objetivo la conservación de las poblaciones de caimán y cocodrilo, así como sus hábitats, con la participación de actores clave de la sociedad.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/caiman-cocodrilo.pdf"
        },
        {
            title: "Programa Nacional de Conservación de Cetáceos",
            description: "El documento aborda la conservación de los cetáceos en El Salvador, enfocado en investigación científica, monitoreo, atención de varamiento, turismo responsable, educación y gobernanza para la conservación.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/cetaceos.pdf"
        },
        {
            title: "Programa Nacional de Conservación de Felinos",
            description: "Una iniciativa para la conservación de especies de felinos en El Salvador. Se basa en la generación de conocimiento, sensibilización de la población, promoción de sellos verdes y educación sobre la importancia de la conservación de felinos.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/felinos.pdf"
        }
    ],
    "República Dominicana": [
        {
            title: "Guía restauración de ecosistemas RD",
            description: "Desarrollado por el Ministerio de Medio Ambiente y Recursos Naturales de República Dominicana, este documento recopila experiencias de restauración ecológica implementadas en el país, abarcando diversos tipos de ecosistemas como humedales, ecosistemas terrestres y cuencas hidrográficas.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/restauracion-rd.pdf"
        },
        {
            title: "Ley Forestal",
            description: "Ley Sectorial Forestal de República Dominicana. Regula y promueve el manejo forestal sostenible, conservación, producción, industrialización y comercialización de los recursos forestales, garantizando la sostenibilidad a largo plazo.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/ley-forestal.pdf"
        },
        {
            title: "Ley Sectorial Biodiversidad",
            description: "Ley publicada en el Diario Oficial de República Dominicana. Detalla disposiciones sobre la formulación de políticas, importancia estratégica de la biodiversidad, investigación científica, y control de especies exóticas invasoras.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/ley-biodiversidad.pdf"
        },
        {
            title: "Ley 202-04 Ley Sectorial de Áreas Protegidas",
            description: "Garantiza la conservación y uso sostenible de las áreas protegidas en República Dominicana. Promueve la cooperación internacional y adopción de incentivos para la conservación.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/ley-areas-protegidas.pdf"
        }
    ],
    "Nicaragua": [
        {
            title: "Iguana Verde",
            description: "Un manual sobre el manejo en cautiverio de la Iguana Verde. Promueve la conservación y el uso responsable de esta especie para mejorar los medios de vida de las comunidades locales.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/iguana-verde.pdf"
        },
        {
            title: "Manual de Buenas Prácticas Ambientales",
            description: "Este documento aborda buenas prácticas ambientales para prevenir incendios forestales en áreas protegidas de Nicaragua. Proporciona estrategias de educación, comunicación y acciones concretas para reducir el riesgo de incendios.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/manual-ambiental.pdf"
        },
        {
            title: "Manual de Murciélagos del Parque Nacional Volcán Masaya",
            description: "Un informe técnico sobre las diversas especies de murciélagos que habitan en el Parque Nacional Volcán Masaya, destacando su importancia ecológica.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/murcielagos-masaya.pdf"
        },
        {
            title: "Manual de Demarcación Física de Áreas Protegidas",
            description: "Proporciona especificaciones técnicas y procedimientos para la instalación de señalización y mojones en áreas protegidas de Nicaragua, promoviendo la conservación y gestión ambiental.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/demarcacion-areas.pdf"
        }
    ],
    "Panamá": [
        {
            title: "Estrategia Nacional de Biodiversidad",
            description: "Documento que menciona la situación de la Diversidad Biológica de Panamá, con estrategias de acción para la conservación de la biodiversidad en el país.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/estrategia-biodiversidad.pdf"
        },
        {
            title: "Atlas Ambiental",
            description: "Este documento contiene información cartográfica y ambiental oficial de Panamá, proporcionando un instrumento de análisis multivariable para la toma de decisiones sobre conservación.",
            image: "https://via.placeholder.com/150",
            link: "https://example.com/atlas-ambiental.pdf"
        }
    ]
};

const countryList = document.getElementById('countryList');
const documentList = document.getElementById('documentList');
const documentModal = new bootstrap.Modal(document.getElementById('documentModal'));
const toastContainer = document.getElementById('toastContainer');
let selectedCountry = null;
let copyToast = new bootstrap.Toast(document.getElementById('copyToast'));

function loadCountries() {
    for (const country in documents) {
        const li = document.createElement('li');
        li.classList.add('list-group-item', 'd-flex', 'align-items-center');

        // Crear la imagen de la bandera
        const flagImg = document.createElement('img');
        const flagFileName = getFlagFileName(country); // Usa la función para obtener el nombre del archivo
        flagImg.src = `img/${flagFileName}`; // Cambia esta ruta a la ubicación de tus imágenes
        flagImg.alt = `${country} flag`;
        flagImg.style.width = '30px'; // Ajusta el tamaño según sea necesario
        flagImg.style.height = 'auto'; // Mantiene la proporción
        flagImg.style.marginRight = '10px'; // Ajusta el valor según sea necesario


        li.appendChild(flagImg);
        li.appendChild(document.createTextNode(` ${country} `)); // Espacio entre la imagen y el texto
        li.onclick = () => loadDocuments(country, li);
        countryList.appendChild(li);
    }
}


function getFlagFileName(country) {
    return country
        .toLowerCase()
        .replace(/á/g, 'a')
        .replace(/é/g, 'e')
        .replace(/í/g, 'i')
        .replace(/ó/g, 'o')
        .replace(/ú/g, 'u')
        .replace(/ñ/g, 'n')
        .replace(/ /g, '_') + '.png'; // Reemplazar espacios con guiones bajos
}



function loadDocuments(country, countryElement) {
    documentList.innerHTML = ''; // Clear document list
    if (selectedCountry) {
        selectedCountry.classList.remove('active');
    }
    
    selectedCountry = countryElement;
    selectedCountry.classList.add('active');

    documents[country].forEach(doc => {
        const li = document.createElement('li');
        li.classList.add('list-group-item', 'd-flex', 'justify-content-between', 'align-items-center');
        li.innerText = doc.title;
        li.onclick = () => showDocumentDetails(doc);
        documentList.appendChild(li);
    });
}

function showDocumentDetails(doc) {
    document.getElementById('documentTitle').innerText = doc.title;
    document.getElementById('documentDescription').innerText = doc.description;
    document.getElementById('documentImage').src = doc.image;

    // Forzar descarga del archivo
    document.getElementById('documentDownloadLink').onclick = (e) => {
        e.preventDefault(); // Evitar que se abra en otra ventana
        forceDownload(doc.link, doc.title);
    };

    document.getElementById('copyLinkButton').onclick = () => {
        navigator.clipboard.writeText(doc.link).then(() => {
            // Mostrar el toast de confirmación
            copyToast.show();
        }).catch(err => {
            console.error('Error al copiar el enlace: ', err);
        });
    };

    documentModal.show();
}

// Función para forzar la descarga
function forceDownload(url, fileName) {
    const a = document.createElement('a');
    a.href = url;
    a.setAttribute('download', fileName); // Asigna un nombre al archivo
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}


// Initialize the country list on page load
loadCountries();